BIN	= $(INSTALLGMD)/bin
LIB	= $(INSTALLGMD)/lib

MC      = m2c
MOCKAFLAGS =
MOCKALIBS = -d ../../reuse/src

DEFS	= DefTable.md Errors.md 
MODS	= DefTable.mi Errors.mi r2l.mi

MODULAGENS    = Scanner.md Scanner.mi Parser.md Parser.mi
OTHERGENS    = Scanner.Tab Parser.Tab
GENS    = $(MODULAGENS) $(OTHERGENS)

EXE     = r2l

include ../../makefilesrc.include

# Generated sources:

Scanner.mi Scanner.md:	r2l.rex
	rex -d r2l.rex;

Parser.mi Parser.md:	r2l.lalr
	lalr -b -d r2l.lalr;

install_modula:	r2l r2l.sh $(LIB)/r2l Scanner.Tab Parser.Tab
	if test $(LIB) = $(BIN); then echo error: BIN = LIB; false; else true; fi
	sed "s;LIB;$(LIB);g" < r2l.sh > $(BIN)/r2l
	chmod a+rx $(BIN)/r2l
	install -c -s -m 755 r2l $(LIB)/r2l
	install -c -m 644 Scanner.Tab $(LIB)/r2l
	install -c -m 644 Parser.Tab $(LIB)/r2l

# installation directories

$(LIB)/r2l:	$(LIB)
	sh -c "if test ! -d $(LIB)/r2l; then mkdir $(LIB)/r2l; else true; fi"

clean:
	rm -f core *.[dimor] ERRORS LISTING _Debug r2l

CLEAN:	clean
	rm -f Scanner.m? Parser.m? *.Tab
