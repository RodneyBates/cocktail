INSTALLBIN	= $(INSTALLGMD)/bin
INSTALLLIB	= $(INSTALLGMD)/lib

MC      = mocka_mtc

INCLUDE = .

BIN = ../../bintobuildwith
REX = $(BIN)/rex
LALR = $(BIN)/lalr

MOCKAFLAGS =
MOCKALIBS = -d ../../reuse/gen

DEFS	= DefTable.md Errors.md 
MODS	= DefTable.mi Errors.mi r2l.mi

MODULAGENS    = Scanner.md Scanner.mi Parser.md Parser.mi
OTHERGENS    = Scanner.Tab Parser.Tab
GENS    = $(MODULAGENS) $(OTHERGENS)

MODULASOURCES = \
   DefTable.md DefTable.mi Errors.md Errors.mi r2l.mi

OTHERSOURCES = r2l.lalr r2l.rex
SOURCES = $(MODULESOURCES) $(OTHERSOURCES) 



EXE     = r2l

include $(INCLUDE)/make.include

# Generated sources:

Scanner.mi Scanner.md Scanner.Tab: ../src/r2l.rex
	$(REX) -d ../src/r2l.rex;

Parser.mi Parser.md Parser.Tab: ../src/r2l.lalr
	$(LALR) -b -d ../src/r2l.lalr;

#install_modula:	r2l ../lib/r2l.sh $(INSTALLLIB)/r2l ../gen/Scanner.Tab ../gen/Parser.Tab
#	if test $(INSTALLLIB) = $(INSTALLBIN); then echo error: INSTALLBIN = INSTALLLIB; false; else true; fi
#	sed "s;LIB;$(INSTALLLIB);g" < ../lib/r2l.sh > $(INSTALLBIN)/r2l
#	chmod a+rx $(INSTALLBIN)/r2l
#	install -c -s -m 755 r2l $(INSTALLLIB)/r2l
#	install -c -m 644 ../gen/Scanner.Tab $(INSTALLLIB)/r2l
#	install -c -m 644 ../gen/Parser.Tab $(INSTALLLIB)/r2l

# installation directories

$(INSTALLLIB)/r2l:	$(INSTALLLIB)
	sh -c "if test ! -d $(INSTALLLIB)/r2l; then mkdir $(INSTALLLIB)/r2l; else true; fi"

clean:
	rm -f core *.[dimor] ERRORS LISTING _Debug r2l

CLEAN:	clean
	rm -f Scanner.m? Parser.m? *.Tab
